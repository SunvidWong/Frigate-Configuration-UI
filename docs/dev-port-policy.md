# 端口使用规范

## 项目端口策略

### 固定端口要求（开发阶段）
开发阶段**必须**使用 **5500** 端口，任何情况下都不允许修改。

### 强制执行条款（必须遵守）
- 开发与预览服务端口统一为 5500，禁止启动任何占用其他端口（如 3000）的开发服务器。
- 严禁通过命令行或环境变量覆盖端口配置（例如 `--port 3000`）。
- 发现不符合规范的运行或提交，应立即停止并整改；不合规的 PR 将被退回。

### 监控与审核
- 本项目已在 `vite.config.ts` 中启用 `strictPort: true`，端口占用不会自动切换，确保强制使用 5500。
- 开发自检：提交代码前，确认本机仅有 5500 端口服务在运行。
  - 可使用 `lsof -i :5500` 与 `lsof -i :3000` 检查端口占用。
  - 如发现误启动的 3000 端口服务，请及时结束：`kill -9 <PID>`。
- 文档审核：确保所有 README/文档示例均指向 `http://localhost:5500`。

### 配置文件
以下配置文件已设置固定端口：

#### 1. vite.config.ts
```typescript
export default defineConfig({
  server: {
    port: 5500, // 固定端口，不可修改
    strictPort: true, // 端口被占用时不自动尝试下一个端口
  },
  preview: {
    port: 5500, // 预览模式也使用相同端口
    strictPort: true, // 确保预览模式也不会自动切换端口
  }
})
```

#### 2. package.json
```json
{
  "scripts": {
    "dev": "vite",
    "preview": "vite preview"
  }
}
```

### 启动命令
- **开发模式**: `npm run dev`
- **预览模式**: `npm run preview`
- **访问地址**: http://localhost:5500

### 端口冲突处理
如果 5500 端口被占用：
1. 停止占用 5500 端口的其他服务
2. 使用 `lsof -i :5500` 查看占用进程
3. 使用 `kill -9 <PID>` 终止占用进程
4. 重新启动开发服务器

### 禁止行为
❌ **严禁**通过命令行参数修改端口：
```bash
# 禁止使用
npm run dev -- --port 3000
vite --port 3000
```

❌ **严禁**修改 vite.config.ts 中的端口配置

❌ **严禁**在代码中硬编码其他端口号

❌ **严禁**同时运行多个开发服务器（例如另启一个 3000 端口），一律只保留 5500。

### 合规检查
开发团队应定期检查：
- [ ] vite.config.ts 端口配置为 5500
- [ ] strictPort 设置为 true
- [ ] 没有命令行端口覆盖
- [ ] 所有文档引用正确端口

### 违规处理
违反端口使用规范的代码提交将被拒绝，需要修正后重新提交。

---
**最后更新**: 2025年10月
**负责人**: 开发团队